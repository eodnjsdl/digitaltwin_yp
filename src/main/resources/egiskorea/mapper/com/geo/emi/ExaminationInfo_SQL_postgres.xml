<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="examinationInfo">
 	
	<select id="selectAdministrationZoneList" parameterType="examinationInfoVO" resultType="administrationZone">
		SELECT 
			DATA_SEQ, GUBUN, DC1.CODE AS CODE1, DC1.CODE_NM AS CODE1_NM, DC2.CODE AS CODE2, DC2.CODE_NM AS CODE2_NM, 
			USER_ID, USER_NM, TO_CHAR(DD.FRST_REGIST_PNTTM, 'YYYY.MM.DD') FRST_REGIST_PNTTM, DD.LAST_UPDUSR_ID, TO_CHAR(DD.LAST_UPDT_PNTTM, 'YYYY.MM.DD') LAST_UPDT_PNTTM
		FROM DT_ADMINISTRATIONZONE DD
		LEFT JOIN COMVNUSERMASTER CV ON DD.FRST_REGISTER_ID = CV.ESNTL_ID
		LEFT JOIN COMTCCMMNDETAILCODE DC1 ON DD.CODE1 = DC1.CODE AND DC1.CODE_ID = 'YPLI'
		LEFT JOIN COMTCCMMNDETAILCODE DC2 ON DD.CODE2 = DC2.CODE AND DC2.CODE_ID = 'YPLI'
		WHERE 1 = 1
		<if test="@egovframework.com.cmm.util.EgovMybaitsUtil@isNotEmpty(code1)">
			AND CODE1 = #{code1}
		</if>
		ORDER BY CODE1, CODE2
		LIMIT #{recordCountPerPage} OFFSET #{firstIndex}
	</select>
 		
	<select id="selectAdministrationZoneListCnt" parameterType="examinationInfoVO" resultType="java.lang.Integer">
		SELECT 
			COUNT(*)
		FROM DT_ADMINISTRATIONZONE DD
		LEFT JOIN COMTCCMMNDETAILCODE DC1 ON DD.CODE1 = DC1.CODE AND DC1.CODE_ID = 'YPLI'
		LEFT JOIN COMTCCMMNDETAILCODE DC2 ON DD.CODE2 = DC2.CODE AND DC2.CODE_ID = 'YPLI'
		WHERE 1 = 1
		<if test="@egovframework.com.cmm.util.EgovMybaitsUtil@isNotEmpty(code1)">
			AND CODE1 = #{code1}
		</if>
	</select>
		
	<insert id="excelExaminationInfoUpload" statementType="CALLABLE">
		<![CDATA[
			CALL EXCEL_SAVE_EXAMINATIONINFO1(					
				#{pnu, mode=IN, jdbcType=VARCHAR}, #{startDate, mode=IN, jdbcType=VARCHAR}, #{endDate, mode=IN, jdbcType=VARCHAR}, #{updateDate, mode=IN, jdbcType=VARCHAR}
				, #{main, mode=IN, jdbcType=VARCHAR}, #{sub, mode=IN, jdbcType=VARCHAR}, #{ori, mode=IN, jdbcType=VARCHAR}
				, #{j0100, mode=IN, jdbcType=VARCHAR}, #{j0200, mode=IN, jdbcType=VARCHAR}, #{j0301, mode=IN, jdbcType=VARCHAR}, #{j0302, mode=IN, jdbcType=VARCHAR}, #{j0401, mode=IN, jdbcType=VARCHAR}
				, #{j0401p, mode=IN, jdbcType=VARCHAR}, #{j0402, mode=IN, jdbcType=VARCHAR}, #{j0402p, mode=IN, jdbcType=VARCHAR}, #{j0403, mode=IN, jdbcType=VARCHAR}, #{j0403p, mode=IN, jdbcType=VARCHAR}
				, #{j0501, mode=IN, jdbcType=VARCHAR}, #{j0501p, mode=IN, jdbcType=VARCHAR}, #{j0502, mode=IN, jdbcType=VARCHAR}, #{j0502p, mode=IN, jdbcType=VARCHAR}, #{j0503, mode=IN, jdbcType=VARCHAR}
				, #{j0503p, mode=IN, jdbcType=VARCHAR}, #{g0100, mode=IN, jdbcType=VARCHAR}, #{g0101, mode=IN, jdbcType=VARCHAR}, #{saveYn, mode=IN, jdbcType=VARCHAR}, #{opinion, mode=IN, jdbcType=VARCHAR}
				, #{frstRegisterId, mode=IN, jdbcType=VARCHAR}, #{lastUpdusrId, mode=IN, jdbcType=VARCHAR}
				
				, #{c0100p, mode=IN, jdbcType=VARCHAR}, #{c0100n, mode=IN, jdbcType=VARCHAR}, #{c0100c, mode=IN, jdbcType=VARCHAR}, #{c0200p, mode=IN, jdbcType=VARCHAR}, #{c0200n, mode=IN, jdbcType=VARCHAR}
				, #{c0200c, mode=IN, jdbcType=VARCHAR}, #{c0301n, mode=IN, jdbcType=VARCHAR}, #{c0301e, mode=IN, jdbcType=VARCHAR}, #{c0302p, mode=IN, jdbcType=VARCHAR}, #{c0302n, mode=IN, jdbcType=VARCHAR}
				, #{c0302c, mode=IN, jdbcType=VARCHAR}, #{c0302e, mode=IN, jdbcType=VARCHAR}, #{c0401p, mode=IN, jdbcType=VARCHAR}, #{c0401n, mode=IN, jdbcType=VARCHAR}, #{c0401c, mode=IN, jdbcType=VARCHAR}
				, #{c0402p, mode=IN, jdbcType=VARCHAR}, #{c0402n, mode=IN, jdbcType=VARCHAR}, #{c0402c, mode=IN, jdbcType=VARCHAR}, #{c0403p, mode=IN, jdbcType=VARCHAR}, #{c0403n, mode=IN, jdbcType=VARCHAR}
				, #{c0403c, mode=IN, jdbcType=VARCHAR}, #{c0500p, mode=IN, jdbcType=VARCHAR}, #{c0500n, mode=IN, jdbcType=VARCHAR}, #{c0500c, mode=IN, jdbcType=VARCHAR}, #{c0601p, mode=IN, jdbcType=VARCHAR}
				, #{c0601n, mode=IN, jdbcType=VARCHAR}, #{c0601c, mode=IN, jdbcType=VARCHAR}, #{c0602p, mode=IN, jdbcType=VARCHAR}, #{c0602n, mode=IN, jdbcType=VARCHAR}, #{c0602c, mode=IN, jdbcType=VARCHAR}
			);
			CALL EXCEL_SAVE_EXAMINATIONINFO2(	
				#{pnu, mode=IN, jdbcType=VARCHAR}					
				, #{l0100p, mode=IN, jdbcType=VARCHAR}, #{l0100n, mode=IN, jdbcType=VARCHAR}, #{l0100c, mode=IN, jdbcType=VARCHAR}, #{l0100e, mode=IN, jdbcType=VARCHAR}, #{l0201p, mode=IN, jdbcType=VARCHAR}
				, #{l0201n, mode=IN, jdbcType=VARCHAR}, #{l0201c, mode=IN, jdbcType=VARCHAR}, #{l0202p, mode=IN, jdbcType=VARCHAR}, #{l0202n, mode=IN, jdbcType=VARCHAR}, #{l0202c, mode=IN, jdbcType=VARCHAR}
				, #{l0202e, mode=IN, jdbcType=VARCHAR}, #{l0301p, mode=IN, jdbcType=VARCHAR}, #{l0301n, mode=IN, jdbcType=VARCHAR}, #{l0301c, mode=IN, jdbcType=VARCHAR}, #{l0302p, mode=IN, jdbcType=VARCHAR}
				, #{l0302n, mode=IN, jdbcType=VARCHAR}, #{l0302c, mode=IN, jdbcType=VARCHAR}, #{l0303p, mode=IN, jdbcType=VARCHAR}, #{l0303n, mode=IN, jdbcType=VARCHAR}, #{l0303c, mode=IN, jdbcType=VARCHAR}
				, #{l0400p, mode=IN, jdbcType=VARCHAR}, #{l0400n, mode=IN, jdbcType=VARCHAR}, #{l0400c, mode=IN, jdbcType=VARCHAR}, #{l0500p, mode=IN, jdbcType=VARCHAR}, #{l0500n, mode=IN, jdbcType=VARCHAR}
				, #{l0500c, mode=IN, jdbcType=VARCHAR}, #{l0601p, mode=IN, jdbcType=VARCHAR}, #{l0601n, mode=IN, jdbcType=VARCHAR}, #{l0601c, mode=IN, jdbcType=VARCHAR}, #{l0602p, mode=IN, jdbcType=VARCHAR}
				, #{l0602n, mode=IN, jdbcType=VARCHAR}, #{l0602c, mode=IN, jdbcType=VARCHAR}
				
				, #{b0101p, mode=IN, jdbcType=VARCHAR}, #{b0101n, mode=IN, jdbcType=VARCHAR}, #{b0101c, mode=IN, jdbcType=VARCHAR}, #{b0102p, mode=IN, jdbcType=VARCHAR}, #{b0102n, mode=IN, jdbcType=VARCHAR}
				, #{b0102c, mode=IN, jdbcType=VARCHAR}, #{b0102e, mode=IN, jdbcType=VARCHAR}, #{b0201p, mode=IN, jdbcType=VARCHAR}, #{b0201n, mode=IN, jdbcType=VARCHAR}, #{b0201c, mode=IN, jdbcType=VARCHAR}
				, #{b0202p, mode=IN, jdbcType=VARCHAR}, #{b0202n, mode=IN, jdbcType=VARCHAR}, #{b0202c, mode=IN, jdbcType=VARCHAR}, #{b0202e, mode=IN, jdbcType=VARCHAR}, #{b0300p, mode=IN, jdbcType=VARCHAR}
				, #{b0300n, mode=IN, jdbcType=VARCHAR}, #{b0300c, mode=IN, jdbcType=VARCHAR}, #{b0400p, mode=IN, jdbcType=VARCHAR}, #{b0400n, mode=IN, jdbcType=VARCHAR}, #{b0400c, mode=IN, jdbcType=VARCHAR}
				, #{b0400e, mode=IN, jdbcType=VARCHAR}, #{b0500p, mode=IN, jdbcType=VARCHAR}, #{b0500n, mode=IN, jdbcType=VARCHAR}, #{b0500c, mode=IN, jdbcType=VARCHAR}, #{b0500e, mode=IN, jdbcType=VARCHAR}
				, #{b0601p, mode=IN, jdbcType=VARCHAR}, #{b0601n, mode=IN, jdbcType=VARCHAR}, #{b0601c, mode=IN, jdbcType=VARCHAR}, #{b0602p, mode=IN, jdbcType=VARCHAR}, #{b0602n, mode=IN, jdbcType=VARCHAR}
				, #{b0602c, mode=IN, jdbcType=VARCHAR}, #{b0602e, mode=IN, jdbcType=VARCHAR}, #{b0700p, mode=IN, jdbcType=VARCHAR}, #{b0700n, mode=IN, jdbcType=VARCHAR}, #{b0700c, mode=IN, jdbcType=VARCHAR}
				, #{b0800p, mode=IN, jdbcType=VARCHAR}, #{b0800n, mode=IN, jdbcType=VARCHAR}, #{b0800c, mode=IN, jdbcType=VARCHAR}, #{b0900p, mode=IN, jdbcType=VARCHAR}, #{b0900n, mode=IN, jdbcType=VARCHAR}
				, #{b0900c, mode=IN, jdbcType=VARCHAR}, #{b0900e, mode=IN, jdbcType=VARCHAR}, #{b1000p, mode=IN, jdbcType=VARCHAR}, #{b1000n, mode=IN, jdbcType=VARCHAR}, #{b1000c, mode=IN, jdbcType=VARCHAR}
				, #{b1100p, mode=IN, jdbcType=VARCHAR}, #{b1100n, mode=IN, jdbcType=VARCHAR}, #{b1100c, mode=IN, jdbcType=VARCHAR}
				
				, #{t0100, mode=IN, jdbcType=VARCHAR}, #{t0200, mode=IN, jdbcType=VARCHAR}, #{t0300, mode=IN, jdbcType=VARCHAR}, #{t0400, mode=IN, jdbcType=VARCHAR}, #{t0500, mode=IN, jdbcType=VARCHAR}
				, #{t0600, mode=IN, jdbcType=VARCHAR}, #{t0700, mode=IN, jdbcType=VARCHAR}
			);
		]]>
	</insert>
		
	<select id="selectAdministrationZone" parameterType="administrationZone" resultType="administrationZone">
		SELECT
			DATA_SEQ, GUBUN, CODE1, CODE2
		FROM DT_ADMINISTRATIONZONE 
		WHERE 1=1
		<if test="@egovframework.com.cmm.util.EgovMybaitsUtil@isNotEmpty(gubun)">
			AND GUBUN = #{gubun}
		</if>
		<if test="@egovframework.com.cmm.util.EgovMybaitsUtil@isNotEmpty(code1)">
			AND CODE1 = #{code1}
		</if>
		<if test="@egovframework.com.cmm.util.EgovMybaitsUtil@isNotEmpty(code2)">
			AND CODE2 = #{code2}
		</if>
		<if test="@egovframework.com.cmm.util.EgovMybaitsUtil@isNotEmpty(dataSeq)">
			AND DATA_SEQ = ${dataSeq}
		</if>
	</select>
	 	
	<insert id="insertAdministrationZone" parameterType="administrationZone">
		INSERT INTO DT_ADMINISTRATIONZONE(
			GUBUN, CODE1, CODE2, FRST_REGISTER_ID, FRST_REGIST_PNTTM, LAST_UPDUSR_ID, LAST_UPDT_PNTTM
		) VALUES(
			#{gubun}, #{code1}, #{code2}, #{frstRegisterId}, now(), #{lastUpdusrId}, now()
		)	
	</insert>
 	
	<update id="updateAdministrationZone" parameterType="administrationZone">
		UPDATE DT_ADMINISTRATIONZONE
		SET LAST_UPDUSR_ID = #{lastUpdusrId},
			LAST_UPDT_PNTTM = now()
		WHERE DATA_SEQ = ${dataSeq}			
	</update>
	
	<delete id="deleteAdministrationZone" parameterType="administrationZone">
		DELETE FROM DT_ADMINISTRATIONZONE WHERE DATA_SEQ = ${dataSeq};
		DELETE FROM DT_LANDCATEGORYINFO WHERE PNU LIKE #{code2} || '%';
		DELETE FROM DT_COMMONINFO WHERE PNU LIKE #{code2} || '%';
		DELETE FROM DT_LANDCHARACTER WHERE PNU LIKE #{code2} || '%';
		DELETE FROM DT_HOUSECHARACTER WHERE PNU LIKE #{code2} || '%';
		DELETE FROM DT_LANDCOVER WHERE PNU LIKE #{code2} || '%';
	</delete>
	
	<select id="selectExaminationInfoList" parameterType="examinationInfoVO" resultType="landCategoryInfo">
		SELECT
			ORG_FID, PNU, SHAPE, START_DATE, END_DATE, UPDATE_DATE, MAIN, SUB,
          	ORI || ' : ' || (SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = ORI AND CC.CODE_ID = 'J0200') AS ORI, 
          	J0100, J0200, J0301, J0302, J0401, 
          	J0401P, J0402, J0402P, J0403, J0403P, 
          	J0501, J0501P, J0502, J0502P, J0503, J0503P, CDC.CODE_DC AS ADDR
		FROM DT_LANDCATEGORYINFO
		LEFT OUTER JOIN COMTCCMMNDETAILCODE CDC ON SUBSTRING(PNU, 1, 10) = SUBSTRING(CDC.CODE, 1, 10) AND CDC.CODE_ID = 'YPLI'       
		WHERE 1=1
		<if test="@egovframework.com.cmm.util.EgovMybaitsUtil@isNotEmpty(code2)">
			AND PNU LIKE '%' || #{code2} || '%'
		</if>
		<choose>
			<when test="@egovframework.com.cmm.util.EgovMybaitsUtil@isEquals(searchMch,0)">
				AND J0100 = '1'
			</when>
			<when test="@egovframework.com.cmm.util.EgovMybaitsUtil@isEquals(searchMch,1)">
				AND J0100 = '2'
			</when>
		</choose>
		<choose>
			<when test="@egovframework.com.cmm.util.EgovMybaitsUtil@isEquals(searchCnd,0)">
				AND MAIN LIKE '%' || #{searchWrd} || '%'
			</when>
			<when test="@egovframework.com.cmm.util.EgovMybaitsUtil@isEquals(searchCnd,1)">
				AND SUB LIKE '%' || #{searchWrd} || '%'
			</when>
			<when test="@egovframework.com.cmm.util.EgovMybaitsUtil@isEquals(searchCnd,2)">
				AND ORI LIKE '%' || #{searchWrd} || '%'
			</when>
		</choose>
		ORDER BY PNU
		LIMIT #{recordCountPerPage} OFFSET #{firstIndex}          
	</select>
	
	<select id="selectExaminationInfoListCnt" parameterType="examinationInfoVO" resultType="java.lang.Integer">
		SELECT 
			COUNT(*)
		FROM DT_LANDCATEGORYINFO       
		WHERE 1=1
		<if test="@egovframework.com.cmm.util.EgovMybaitsUtil@isNotEmpty(code2)">
			AND PNU LIKE '%' || #{code2} || '%'
		</if>
		<choose>
			<when test="@egovframework.com.cmm.util.EgovMybaitsUtil@isEquals(searchMch,0)">
				AND J0100 = '1'
			</when>
			<when test="@egovframework.com.cmm.util.EgovMybaitsUtil@isEquals(searchMch,1)">
				AND J0100 = '2'
			</when>
		</choose>
		<choose>
			<when test="@egovframework.com.cmm.util.EgovMybaitsUtil@isEquals(searchCnd,0)">
				AND MAIN LIKE '%' || #{searchWrd} || '%'
			</when>
			<when test="@egovframework.com.cmm.util.EgovMybaitsUtil@isEquals(searchCnd,1)">
				AND SUB LIKE '%' || #{searchWrd} || '%'
			</when>
			<when test="@egovframework.com.cmm.util.EgovMybaitsUtil@isEquals(searchCnd,2)">
				AND ORI LIKE '%' || #{searchWrd} || '%'
			</when>
		</choose>
	</select>
	
	<select id="selectExaminationInfo" parameterType="examinationInfoVO" resultType="examinationInfo">
		SELECT
			ORG_FID, DLCI.PNU, SHAPE, START_DATE, END_DATE, UPDATE_DATE, MAIN, SUB, OPINION,
			(SELECT CODE_DC FROM COMTCCMMNDETAILCODE WHERE CODE_ID = 'YPLI' AND SUBSTRING(DLCI.PNU, 1, 10) = SUBSTRING(CODE, 1, 10)) AS ADDR, 
			CASE WHEN TRIM(ORI) != '' THEN ORI || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = ORI AND CC.CODE_ID = 'J0200'), '(-)') ELSE ORI END AS ORI,
			CASE WHEN TRIM(J0100) != '' THEN J0100 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = J0100 AND CC.CODE_ID = 'J0100'), '(-)') ELSE J0100 END AS J0100,
			CASE WHEN TRIM(J0200) != '' THEN J0200 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = J0200 AND CC.CODE_ID = 'J0200'), '(-)') ELSE J0200 END AS J0200,
			CASE WHEN TRIM(J0301) != '' THEN J0301 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = J0301 AND CC.CODE_ID = 'J0301'), '(-)') ELSE J0301 END AS J0301,
			CASE WHEN TRIM(J0302) != '' THEN J0302 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = J0302 AND CC.CODE_ID = 'J0302'), '(-)') ELSE J0302 END AS J0302,
			CASE WHEN TRIM(J0401) != '' THEN J0401 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = J0401 AND CC.CODE_ID = 'J0401'), '(-)') ELSE J0401 END AS J0401,
			CASE WHEN TRIM(J0401P) != '' THEN COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = J0401P AND CC.CODE_ID = 'J0401P') || '%', '(-)') ELSE J0401P END AS J0401P,
			CASE WHEN TRIM(J0402) != '' THEN J0402 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = J0402 AND CC.CODE_ID = 'J0401'), '(-)') ELSE J0402 END AS J0402, 
			CASE WHEN TRIM(J0402P) != '' THEN COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = J0402P AND CC.CODE_ID = 'J0401P') || '%', '(-)') ELSE J0402P END AS J0402P,
			CASE WHEN TRIM(J0403) != '' THEN J0403 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = J0403 AND CC.CODE_ID = 'J0401'), '(-)') ELSE J0403 END AS J0403, 
			CASE WHEN TRIM(J0403P) != '' THEN COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = J0403P AND CC.CODE_ID = 'J0401P') || '%', '(-)') ELSE J0403P END AS J0403P,
			CASE WHEN TRIM(J0501) != '' THEN J0501 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = J0501 AND CC.CODE_ID = 'J0501'), '(-)') ELSE J0501 END AS J0501, 
			CASE WHEN TRIM(J0501P) != '' THEN COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = J0501P AND CC.CODE_ID = 'J0501P') || '%', '(-)') ELSE J0501P END AS J0501P,
			CASE WHEN TRIM(J0502) != '' THEN J0502 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = J0502 AND CC.CODE_ID = 'J0501'), '(-)') ELSE J0502 END AS J0502, 
			CASE WHEN TRIM(J0502P) != '' THEN COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = J0502P AND CC.CODE_ID = 'J0501P') || '%', '(-)') ELSE J0502P END AS J0502P,
			CASE WHEN TRIM(J0503) != '' THEN J0503 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = J0503 AND CC.CODE_ID = 'J0501'), '(-)') ELSE J0503 END AS J0503, 
			CASE WHEN TRIM(J0503P) != '' THEN COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = J0503P AND CC.CODE_ID = 'J0501P') || '%', '(-)') ELSE J0503P END AS J0503P,
			CASE WHEN TRIM(G0100) != '' THEN G0100 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = G0100 AND CC.CODE_ID = 'G0100'), '(-)') ELSE G0100 END AS G0100, 
			CASE WHEN TRIM(G0101) != '' THEN G0101 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = G0100 AND CC.CODE_ID = 'G0100'), '(-)') ELSE G0101 END AS G0101, 
			CASE WHEN TRIM(C0100P) != '' THEN C0100P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0100P AND CC.CODE_ID = 'C0100'), '(-)') ELSE C0100P END AS C0100P,
			CASE WHEN TRIM(C0100N) != '' THEN C0100N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0100N AND CC.CODE_ID = 'C0100'), '(-)') ELSE C0100N END AS C0100N,
			CASE WHEN TRIM(C0100C) != '' THEN C0100C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0100C AND CC.CODE_ID = 'C0100'), '(-)') ELSE C0100C END AS C0100C,
			CASE WHEN TRIM(C0200P) != '' THEN C0200P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0200P AND CC.CODE_ID = 'C0200'), '(-)') ELSE C0200P END AS C0200P,
			CASE WHEN TRIM(C0200N) != '' THEN C0200N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0200N AND CC.CODE_ID = 'C0200'), '(-)') ELSE C0200N END AS C0200N,
			CASE WHEN TRIM(C0200C) != '' THEN C0200C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0200C AND CC.CODE_ID = 'C0200'), '(-)') ELSE C0200C END AS C0200C,
			CASE WHEN TRIM(C0301N) != '' THEN C0301N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0301N AND CC.CODE_ID = 'C0301'), '(-)') ELSE C0301N END AS C0301N,
			CASE WHEN TRIM(C0301E) != '' THEN C0301E || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0301E AND CC.CODE_ID = 'C0301'), '(-)') ELSE C0301E END AS C0301E,
			CASE WHEN TRIM(C0302P) != '' THEN C0302P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0302P AND CC.CODE_ID = 'C0302'), '(-)') ELSE C0302P END AS C0302P,
			CASE WHEN TRIM(C0302N) != '' THEN C0302N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0302N AND CC.CODE_ID = 'C0302'), '(-)') ELSE C0302N END AS C0302N,
			CASE WHEN TRIM(C0302C) != '' THEN C0302C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0302C AND CC.CODE_ID = 'C0302'), '(-)') ELSE C0302C END AS C0302C,
			CASE WHEN TRIM(C0302E) != '' THEN C0302E || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0302E AND CC.CODE_ID = 'C0302'), '(-)') ELSE C0302E END AS C0302E,
			CASE WHEN TRIM(C0401P) != '' THEN C0401P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0401P AND CC.CODE_ID = 'C0401'), '(-)') ELSE C0401P END AS C0401P,
			CASE WHEN TRIM(C0401N) != '' THEN C0401N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0401N AND CC.CODE_ID = 'C0401'), '(-)') ELSE C0401N END AS C0401N,
			CASE WHEN TRIM(C0401C) != '' THEN C0401C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0401C AND CC.CODE_ID = 'C0401'), '(-)') ELSE C0401C END AS C0401C,
			CASE WHEN TRIM(C0402P) != '' THEN C0402P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0402P AND CC.CODE_ID = 'C0402'), '(-)') ELSE C0402P END AS C0402P,
			CASE WHEN TRIM(C0402N) != '' THEN C0402N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0402N AND CC.CODE_ID = 'C0402'), '(-)') ELSE C0402N END AS C0402N,
			CASE WHEN TRIM(C0402C) != '' THEN C0402C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0402C AND CC.CODE_ID = 'C0402'), '(-)') ELSE C0402C END AS C0402C,
			CASE WHEN TRIM(C0403P) != '' THEN C0403P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0403P AND CC.CODE_ID = 'C0403'), '(-)') ELSE C0403P END AS C0403P,
			CASE WHEN TRIM(C0403N) != '' THEN C0403N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0403N AND CC.CODE_ID = 'C0403'), '(-)') ELSE C0403N END AS C0403N,
			CASE WHEN TRIM(C0403C) != '' THEN C0403C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0403C AND CC.CODE_ID = 'C0403'), '(-)') ELSE C0403C END AS C0403C,
			CASE WHEN TRIM(C0500P) != '' THEN C0500P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0500P AND CC.CODE_ID = 'C0500'), '(-)') ELSE C0500P END AS C0500P,
			CASE WHEN TRIM(C0500N) != '' THEN C0500N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0500N AND CC.CODE_ID = 'C0500'), '(-)') ELSE C0500N END AS C0500N,
			CASE WHEN TRIM(C0500C) != '' THEN C0500C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0500C AND CC.CODE_ID = 'C0500'), '(-)') ELSE C0500C END AS C0500C,
			CASE WHEN TRIM(C0601P) != '' THEN C0601P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0601P AND CC.CODE_ID = 'C0601'), '(-)') ELSE C0601P END AS C0601P,
			CASE WHEN TRIM(C0601N) != '' THEN C0601N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0601N AND CC.CODE_ID = 'C0601'), '(-)') ELSE C0601N END AS C0601N,
			CASE WHEN TRIM(C0601C) != '' THEN C0601C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0601C AND CC.CODE_ID = 'C0601'), '(-)') ELSE C0601C END AS C0601C,
			CASE WHEN TRIM(C0602P) != '' THEN C0602P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0602P AND CC.CODE_ID = 'C0602'), '(-)') ELSE C0602P END AS C0602P,
			CASE WHEN TRIM(C0602N) != '' THEN C0602N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0602N AND CC.CODE_ID = 'C0602'), '(-)') ELSE C0602N END AS C0602N,
			CASE WHEN TRIM(C0602C) != '' THEN C0602C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = C0602C AND CC.CODE_ID = 'C0602'), '(-)') ELSE C0602C END AS C0602C,
			CASE WHEN TRIM(L0100P) != '' THEN L0100P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0100P AND CC.CODE_ID = 'L0100'), '(-)') ELSE L0100P END AS L0100P,
			CASE WHEN TRIM(L0100N) != '' THEN L0100N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0100N AND CC.CODE_ID = 'L0100'), '(-)') ELSE L0100N END AS L0100N,
			CASE WHEN TRIM(L0100C) != '' THEN L0100C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0100C AND CC.CODE_ID = 'L0100'), '(-)') ELSE L0100C END AS L0100C,
			CASE WHEN TRIM(L0100E) != '' THEN L0100E || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0100E AND CC.CODE_ID = 'L0100'), '(-)') ELSE L0100E END AS L0100E,
			CASE WHEN TRIM(L0201P) != '' THEN L0201P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0201P AND CC.CODE_ID = 'L0201'), '(-)') ELSE L0201P END AS L0201P,
			CASE WHEN TRIM(L0201N) != '' THEN L0201N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0201N AND CC.CODE_ID = 'L0201'), '(-)') ELSE L0201N END AS L0201N,
			CASE WHEN TRIM(L0201C) != '' THEN L0201C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0201C AND CC.CODE_ID = 'L0201'), '(-)') ELSE L0201C END AS L0201C,
			CASE WHEN TRIM(L0202P) != '' THEN L0202P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0202P AND CC.CODE_ID = 'L0202'), '(-)') ELSE L0202P END AS L0202P,
			CASE WHEN TRIM(L0202N) != '' THEN L0202N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0202N AND CC.CODE_ID = 'L0202'), '(-)') ELSE L0202N END AS L0202N,
			CASE WHEN TRIM(L0202C) != '' THEN L0202C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0202C AND CC.CODE_ID = 'L0202'), '(-)') ELSE L0202C END AS L0202C,
			CASE WHEN TRIM(L0202E) != '' THEN L0202E || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0202E AND CC.CODE_ID = 'L0202'), '(-)') ELSE L0202E END AS L0202E,
			CASE WHEN TRIM(L0301P) != '' THEN L0301P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0301P AND CC.CODE_ID = 'L0301'), '(-)') ELSE L0301P END AS L0301P,
			CASE WHEN TRIM(L0301N) != '' THEN L0301N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0301N AND CC.CODE_ID = 'L0301'), '(-)') ELSE L0301N END AS L0301N,
			CASE WHEN TRIM(L0301C) != '' THEN L0301C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0301C AND CC.CODE_ID = 'L0301'), '(-)') ELSE L0301C END AS L0301C,
			CASE WHEN TRIM(L0302P) != '' THEN L0302P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0302P AND CC.CODE_ID = 'L0302'), '(-)') ELSE L0302P END AS L0302P,
			CASE WHEN TRIM(L0302N) != '' THEN L0302N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0302N AND CC.CODE_ID = 'L0302'), '(-)') ELSE L0302N END AS L0302N,
			CASE WHEN TRIM(L0302C) != '' THEN L0302C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0302C AND CC.CODE_ID = 'L0302'), '(-)') ELSE L0302C END AS L0302C,
			CASE WHEN TRIM(L0303P) != '' THEN L0303P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0303P AND CC.CODE_ID = 'L0303'), '(-)') ELSE L0303P END AS L0303P,
			CASE WHEN TRIM(L0303N) != '' THEN L0303N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0303N AND CC.CODE_ID = 'L0303'), '(-)') ELSE L0303N END AS L0303N,
			CASE WHEN TRIM(L0303C) != '' THEN L0303C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0303C AND CC.CODE_ID = 'L0303'), '(-)') ELSE L0303C END AS L0303C,
			CASE WHEN TRIM(L0400P) != '' THEN L0400P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0400P AND CC.CODE_ID = 'L0400'), '(-)') ELSE L0400P END AS L0400P,
			CASE WHEN TRIM(L0400N) != '' THEN L0400N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0400N AND CC.CODE_ID = 'L0400'), '(-)') ELSE L0400N END AS L0400N,
			CASE WHEN TRIM(L0400C) != '' THEN L0400C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0400C AND CC.CODE_ID = 'L0400'), '(-)') ELSE L0400C END AS L0400C,
			CASE WHEN TRIM(L0500P) != '' THEN L0500P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0500P AND CC.CODE_ID = 'L0500'), '(-)') ELSE L0500P END AS L0500P,
			CASE WHEN TRIM(L0500N) != '' THEN L0500N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0500N AND CC.CODE_ID = 'L0500'), '(-)') ELSE L0500N END AS L0500N,
			CASE WHEN TRIM(L0500C) != '' THEN L0500C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0500C AND CC.CODE_ID = 'L0500'), '(-)') ELSE L0500C END AS L0500C,
			CASE WHEN TRIM(L0601P) != '' THEN L0601P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0601P AND CC.CODE_ID = 'L0601'), '(-)') ELSE L0601P END AS L0601P,
			CASE WHEN TRIM(L0601N) != '' THEN L0601N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0601N AND CC.CODE_ID = 'L0601'), '(-)') ELSE L0601N END AS L0601N,
			CASE WHEN TRIM(L0601C) != '' THEN L0601C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0601C AND CC.CODE_ID = 'L0601'), '(-)') ELSE L0601C END AS L0601C,
			CASE WHEN TRIM(L0602P) != '' THEN L0602P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0602P AND CC.CODE_ID = 'L0602'), '(-)') ELSE L0602P END AS L0602P,
			CASE WHEN TRIM(L0602N) != '' THEN L0602N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0602N AND CC.CODE_ID = 'L0602'), '(-)') ELSE L0602N END AS L0602N,
			CASE WHEN TRIM(L0602C) != '' THEN L0602C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = L0602C AND CC.CODE_ID = 'L0602'), '(-)') ELSE L0602C END AS L0602C,		      		      																	      		      		            
			CASE WHEN TRIM(B0101P) != '' THEN B0101P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0101P AND CC.CODE_ID = 'B0101'), '(-)') ELSE B0101P END AS B0101P,
			CASE WHEN TRIM(B0101N) != '' THEN B0101N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0101N AND CC.CODE_ID = 'B0101'), '(-)') ELSE B0101N END AS B0101N,
			CASE WHEN TRIM(B0101C) != '' THEN B0101C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0101C AND CC.CODE_ID = 'B0101'), '(-)') ELSE B0101C END AS B0101C,
			CASE WHEN TRIM(B0102P) != '' THEN B0102P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0102P AND CC.CODE_ID = 'B0102'), '(-)') ELSE B0102P END AS B0102P,
			CASE WHEN TRIM(B0102N) != '' THEN B0102N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0102N AND CC.CODE_ID = 'B0102'), '(-)') ELSE B0102N END AS B0102N,
			CASE WHEN TRIM(B0102C) != '' THEN B0102C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0102C AND CC.CODE_ID = 'B0102'), '(-)') ELSE B0102C END AS B0102C,
			CASE WHEN TRIM(B0102E) != '' THEN B0102E || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0102E AND CC.CODE_ID = 'B0102'), '(-)') ELSE B0102E END AS B0102E,
			CASE WHEN TRIM(B0201P) != '' THEN B0201P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0201P AND CC.CODE_ID = 'B0201'), '(-)') ELSE B0201P END AS B0201P,
			CASE WHEN TRIM(B0201N) != '' THEN B0201N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0201N AND CC.CODE_ID = 'B0201'), '(-)') ELSE B0201N END AS B0201N,
			CASE WHEN TRIM(B0201C) != '' THEN B0201C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0201C AND CC.CODE_ID = 'B0201'), '(-)') ELSE B0201C END AS B0201C,
			CASE WHEN TRIM(B0202P) != '' THEN B0202P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0202P AND CC.CODE_ID = 'B0202'), '(-)') ELSE B0202P END AS B0202P,
			CASE WHEN TRIM(B0202N) != '' THEN B0202N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0202N AND CC.CODE_ID = 'B0202'), '(-)') ELSE B0202N END AS B0202N,
			CASE WHEN TRIM(B0202C) != '' THEN B0202C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0202C AND CC.CODE_ID = 'B0202'), '(-)') ELSE B0202C END AS B0202C,
			CASE WHEN TRIM(B0202E) != '' THEN B0202E || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0202E AND CC.CODE_ID = 'B0202'), '(-)') ELSE B0202E END AS B0202E,
			CASE WHEN TRIM(B0300P) != '' THEN B0300P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0300P AND CC.CODE_ID = 'B0300'), '(-)') ELSE B0300P END AS B0300P,
			CASE WHEN TRIM(B0300N) != '' THEN B0300N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0300N AND CC.CODE_ID = 'B0300'), '(-)') ELSE B0300N END AS B0300N,
			CASE WHEN TRIM(B0300C) != '' THEN B0300C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0300C AND CC.CODE_ID = 'B0300'), '(-)') ELSE B0300C END AS B0300C,
			CASE WHEN TRIM(B0400P) != '' THEN B0400P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0400P AND CC.CODE_ID = 'B0400'), '(-)') ELSE B0400P END AS B0400P,
			CASE WHEN TRIM(B0400N) != '' THEN B0400N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0400N AND CC.CODE_ID = 'B0400'), '(-)') ELSE B0400N END AS B0400N,
			CASE WHEN TRIM(B0400C) != '' THEN B0400C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0400C AND CC.CODE_ID = 'B0400'), '(-)') ELSE B0400C END AS B0400C,
			CASE WHEN TRIM(B0400E) != '' THEN B0400E || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0400E AND CC.CODE_ID = 'B0400'), '(-)') ELSE B0400E END AS B0400E,
			CASE WHEN TRIM(B0500P) != '' THEN B0500P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0500P AND CC.CODE_ID = 'B0500'), '(-)') ELSE B0500P END AS B0500P,
			CASE WHEN TRIM(B0500N) != '' THEN B0500N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0500N AND CC.CODE_ID = 'B0500'), '(-)') ELSE B0500N END AS B0500N,
			CASE WHEN TRIM(B0500C) != '' THEN B0500C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0500C AND CC.CODE_ID = 'B0500'), '(-)') ELSE B0500C END AS B0500C,
			CASE WHEN TRIM(B0500E) != '' THEN B0500E || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0500E AND CC.CODE_ID = 'B0500'), '(-)') ELSE B0500E END AS B0500E,
			CASE WHEN TRIM(B0601P) != '' THEN B0601P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0601P AND CC.CODE_ID = 'B0601'), '(-)') ELSE B0601P END AS B0601P,
			CASE WHEN TRIM(B0601N) != '' THEN B0601N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0601N AND CC.CODE_ID = 'B0601'), '(-)') ELSE B0601N END AS B0601N,
			CASE WHEN TRIM(B0601C) != '' THEN B0601C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0601C AND CC.CODE_ID = 'B0601'), '(-)') ELSE B0601C END AS B0601C,
			CASE WHEN TRIM(B0602P) != '' THEN B0602P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0602P AND CC.CODE_ID = 'B0602'), '(-)') ELSE B0602P END AS B0602P,
			CASE WHEN TRIM(B0602N) != '' THEN B0602N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0602N AND CC.CODE_ID = 'B0602'), '(-)') ELSE B0602N END AS B0602N,
			CASE WHEN TRIM(B0602C) != '' THEN B0602C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0602C AND CC.CODE_ID = 'B0602'), '(-)') ELSE B0602C END AS B0602C,
			CASE WHEN TRIM(B0602E) != '' THEN B0602E || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0602E AND CC.CODE_ID = 'B0602'), '(-)') ELSE B0602E END AS B0602E,
			CASE WHEN TRIM(B0700P) != '' THEN B0700P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0700P AND CC.CODE_ID = 'B0700'), '(-)') ELSE B0700P END AS B0700P,
			CASE WHEN TRIM(B0700N) != '' THEN B0700N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0700N AND CC.CODE_ID = 'B0700'), '(-)') ELSE B0700N END AS B0700N,
			CASE WHEN TRIM(B0700C) != '' THEN B0700C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0700C AND CC.CODE_ID = 'B0700'), '(-)') ELSE B0700C END AS B0700C,
			CASE WHEN TRIM(B0800P) != '' THEN B0800P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0800P AND CC.CODE_ID = 'B0800'), '(-)') ELSE B0800P END AS B0800P,
			CASE WHEN TRIM(B0800N) != '' THEN B0800N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0800N AND CC.CODE_ID = 'B0800'), '(-)') ELSE B0800N END AS B0800N,
			CASE WHEN TRIM(B0800C) != '' THEN B0800C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0800C AND CC.CODE_ID = 'B0800'), '(-)') ELSE B0800C END AS B0800C,
			CASE WHEN TRIM(B0900P) != '' THEN B0900P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0900P AND CC.CODE_ID = 'B0900'), '(-)') ELSE B0900P END AS B0900P,
			CASE WHEN TRIM(B0900N) != '' THEN B0900N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0900N AND CC.CODE_ID = 'B0900'), '(-)') ELSE B0900N END AS B0900N,
			CASE WHEN TRIM(B0900C) != '' THEN B0900C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0900C AND CC.CODE_ID = 'B0900'), '(-)') ELSE B0900C END AS B0900C,
			CASE WHEN TRIM(B0900E) != '' THEN B0900E || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B0900E AND CC.CODE_ID = 'B0900'), '(-)') ELSE B0900E END AS B0900E,
			CASE WHEN TRIM(B1000P) != '' THEN B1000P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B1000P AND CC.CODE_ID = 'B1000'), '(-)') ELSE B1000P END AS B1000P,
			CASE WHEN TRIM(B1000N) != '' THEN B1000N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B1000N AND CC.CODE_ID = 'B1000'), '(-)') ELSE B1000N END AS B1000N,
			CASE WHEN TRIM(B1000C) != '' THEN B1000C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B1000C AND CC.CODE_ID = 'B1000'), '(-)') ELSE B1000C END AS B1000C,
			CASE WHEN TRIM(B1100P) != '' THEN B1100P || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B1100P AND CC.CODE_ID = 'B1100'), '(-)') ELSE B1100P END AS B1100P,
			CASE WHEN TRIM(B1100N) != '' THEN B1100N || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B1100N AND CC.CODE_ID = 'B1100'), '(-)') ELSE B1100N END AS B1100N,
			CASE WHEN TRIM(B1100C) != '' THEN B1100C || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = B1100C AND CC.CODE_ID = 'B1100'), '(-)') ELSE B1100C END AS B1100C,
			CASE WHEN TRIM(T0100) != '' THEN T0100 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = T0100 AND CC.CODE_ID = 'T0100'), '(-)') ELSE G0101 END AS T0100,
			CASE WHEN TRIM(T0200) != '' THEN T0200 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = T0200 AND CC.CODE_ID = 'T0200'), '(-)') ELSE G0101 END AS T0200,
			CASE WHEN TRIM(T0300) != '' THEN T0300 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = T0300 AND CC.CODE_ID = 'T0300'), '(-)') ELSE G0101 END AS T0300,
			CASE WHEN TRIM(T0400) != '' THEN T0400 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = T0400 AND CC.CODE_ID = 'T0400'), '(-)') ELSE G0101 END AS T0400,
			CASE WHEN TRIM(T0500) != '' THEN T0500 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = T0500 AND CC.CODE_ID = 'T0500'), '(-)') ELSE G0101 END AS T0500,
			CASE WHEN TRIM(T0600) != '' THEN T0600 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = T0600 AND CC.CODE_ID = 'T0600'), '(-)') ELSE G0101 END AS T0600,
			CASE WHEN TRIM(T0700) != '' THEN T0700 || ' : ' || COALESCE((SELECT CODE_NM FROM COMTCCMMNDETAILCODE CDC LEFT JOIN COMTCCMMNCODE CC ON CDC.CODE_ID = CC.CODE_ID WHERE CDC.CODE = T0700 AND CC.CODE_ID = 'T0700'), '(-)') ELSE G0101 END AS T0700
		FROM DT_LANDCATEGORYINFO DLCI
		LEFT JOIN DT_COMMONINFO DC ON DLCI.PNU = DC.PNU
		LEFT JOIN DT_LANDCHARACTER DL ON DLCI.PNU = DL.PNU
		LEFT JOIN DT_HOUSECHARACTER DH ON DLCI.PNU = DH.PNU
		LEFT JOIN DT_LANDCOVER DLC ON DLCI.PNU = DLC.PNU
		WHERE DLCI.PNU = #{pnu} 	
	</select>
	
	<select id="updateExaminationInfoView" parameterType="examinationInfoVO" resultType="examinationInfo">
		SELECT
			ORG_FID, DLCI.PNU, SHAPE, START_DATE, END_DATE, UPDATE_DATE, MAIN, SUB, OPINION,
			ORI, J0100, J0200, J0301, J0302, J0401, J0401P, J0402, J0402P, J0403, J0403P, J0501, J0501P, J0502, J0502P, J0503, J0503P, G0100, G0101, 
			C0100P, C0100N, C0100C, C0200P, C0200N, C0200C, C0301N, C0301E, C0302P, C0302N, C0302C, C0302E, C0401P, C0401N, C0401C, C0402P, C0402N, C0402C, 
			C0403P, C0403N, C0403C, C0500P, C0500N, C0500C, C0601P, C0601N, C0601C, C0602P, C0602N, C0602C, 
			L0100P, L0100N, L0100C, L0100E, L0201P, L0201N, L0201C, L0202P, L0202N, L0202C, L0202E, L0301P, L0301N, L0301C, L0302P, L0302N, L0302C, 
			L0303P, L0303N, L0303C, L0400P, L0400N, L0400C, L0500P, L0500N, L0500C, L0601P, L0601N, L0601C, L0602P, L0602N, L0602C, 
			B0101P, B0101N, B0101C, B0102P, B0102N, B0102C, B0102E, B0201P, B0201N, B0201C, B0202P, B0202N, B0202C, B0202E, B0300P, B0300N, B0300C, 
			B0400P, B0400N, B0400C, B0400E, B0500P, B0500N, B0500C, B0500E, B0601P, B0601N, B0601C, B0602P, B0602N, B0602C, B0602E, B0700P, B0700N, B0700C, 
			B0800P, B0800N, B0800C, B0900P, B0900N, B0900C, B0900E, B1000P, B1000N, B1000C, B1100P, B1100N, B1100C, 
			T0100, T0200, T0300, T0400, T0500, T0600, T0700, 
			(SELECT CODE_DC FROM COMTCCMMNDETAILCODE WHERE CODE_ID = 'YPLI' AND SUBSTRING(DLCI.PNU, 1, 10) = SUBSTRING(CODE, 1, 10)) AS ADDR 
		FROM DT_LANDCATEGORYINFO DLCI
		LEFT JOIN DT_COMMONINFO DC ON DLCI.PNU = DC.PNU
		LEFT JOIN DT_LANDCHARACTER DL ON DLCI.PNU = DL.PNU
		LEFT JOIN DT_HOUSECHARACTER DH ON DLCI.PNU = DH.PNU
		LEFT JOIN DT_LANDCOVER DLC ON DLCI.PNU = DLC.PNU
		WHERE DLCI.PNU = #{pnu} 
	</select>
	
	<update id="updateLandCategoryInfo" parameterType="examinationInfo">
		UPDATE DT_LANDCATEGORYINFO
		SET MAIN = #{main}			
			, SUB = #{sub}
			, J0100 = #{j0100}
			, J0200 = #{j0200}
			, J0301 = #{j0301} 
			, J0302 = #{j0302} 
			, J0401 = #{j0401}
			, J0401P = #{j0401p}
			, J0402 = #{j0402}
			, J0402P = #{j0402p}
			, J0403 = #{j0403}
			, J0403P = #{j0403p}
			, J0501 = #{j0501}	
			, J0501P = #{j0501p}
			, J0502 = #{j0502}
			, J0502P = #{j0502p}
			, J0503 = #{j0503}
			, J0503P = #{j0503p}
			, G0100 = #{g0100}
			, G0101 = #{g0101}
			, OPINION = #{opinion}
			, LAST_UPDT_PNTTM = NOW()
          	, LAST_UPDUSR_ID = #{lastUpdusrId}
		WHERE PNU = #{pnu}
	</update>
	
	<update id="updateCommonInfo" parameterType="examinationInfo">
		UPDATE DT_COMMONINFO
		SET C0100P = #{c0100p}
			, C0100N = #{c0100n}
			, C0100C = #{c0100c}
			, C0200P = #{c0200p}
			, C0200N = #{c0200n}
			, C0200C = #{c0200c}
			, C0301N = #{c0301n}
			, C0301E = #{c0301e}
			, C0302P = #{c0302p}
			, C0302N = #{c0302n}
			, C0302C = #{c0302c}
			, C0302E = #{c0302e}
			, C0401P = #{c0401p}
			, C0401N = #{c0401n}
			, C0401C = #{c0401c}
			, C0402P = #{c0402p}
			, C0402N = #{c0402n}
			, C0402C = #{c0402c}
			, C0403P = #{c0403p}
			, C0403N = #{c0403n}
			, C0403C = #{c0403c}
			, C0500P = #{c0500p}
			, C0500N = #{c0500n}
			, C0500C = #{c0500c}
			, C0601P = #{c0601p}
			, C0601N = #{c0601n}
			, C0601C = #{c0601c}
			, C0602P = #{c0602p}
			, C0602N = #{c0602n}
			, C0602C = #{c0602c}
		WHERE PNU = #{pnu}
	</update>
	
	<update id="updateLandCharacter" parameterType="examinationInfo">
		<![CDATA[
			UPDATE DT_LANDCHARACTER
				SET L0100P = #{l0100p}
				, L0100N = #{l0100n}
				, L0100C = #{l0100c}
				, L0100E = #{l0100e}
				, L0201P = #{l0201p}
				, L0201N = #{l0201n}
				, L0201C = #{l0201c}
				, L0202P = #{l0202p}
				, L0202N = #{l0202n}
				, L0202C = #{l0202c}
				, L0202E = #{l0202e}
				, L0301P = #{l0301p}
				, L0301N = #{l0301n}
				, L0301C = #{l0301c}
				, L0302P = #{l0302p}
				, L0302N = #{l0302n}
				, L0302C = #{l0302c}
				, L0303P = #{l0303p}
				, L0303N = #{l0303n}
				, L0303C = #{l0303c}
				, L0400P = #{l0400p}
				, L0400N = #{l0400n}
				, L0400C = #{l0400c}
				, L0500P = #{l0500p}
				, L0500N = #{l0500n}
				, L0500C = #{l0500c}
				, L0601P = #{l0601p}
				, L0601N = #{l0601n}
				, L0601C = #{l0601c}
				, L0602P = #{l0602p}
				, L0602N = #{l0602n}
				, L0602C = #{l0602c}	
			WHERE PNU = #{pnu}
		]]>				
	</update>
	
	<update id="updateHouseCharacter" parameterType="examinationInfo">
		<![CDATA[
			UPDATE DT_HOUSECHARACTER
				SET B0101P = #{b0101p}
				, B0101N = #{b0101n}
				, B0101C = #{b0101c}
				, B0102P = #{b0102p}
				, B0102N = #{b0102n}
				, B0102C = #{b0102c}
				, B0102E = #{b0102e}
				, B0201P = #{b0201p}
				, B0201N = #{b0201n}
				, B0201C = #{b0201c}
				, B0202P = #{b0202p}
				, B0202N = #{b0202n}
				, B0202C = #{b0202c}
				, B0202E = #{b0202e}
				, B0300P = #{b0300p}
				, B0300N = #{b0300n}
				, B0300C = #{b0300c}
				, B0400P = #{b0400p}
				, B0400N = #{b0400n}
				, B0400C = #{b0400c}
				, B0400E = #{b0400e}
				, B0500P = #{b0500p}
				, B0500N = #{b0500n}
				, B0500C = #{b0500c}
				, B0500E = #{b0500e}
				, B0601P = #{b0601p}
				, B0601N = #{b0601n}
				, B0601C = #{b0601c}
				, B0602P = #{b0602p}
				, B0602N = #{b0602n}
				, B0602C = #{b0602c}
				, B0602E = #{b0602e}
				, B0700P = #{b0700p}
				, B0700N = #{b0700n}
				, B0700C = #{b0700c}
				, B0800P = #{b0800p}
				, B0800N = #{b0800n}
				, B0800C = #{b0800c}
				, B0900P = #{b0900p}
				, B0900N = #{b0900n}
				, B0900C = #{b0900c}
				, B0900E = #{b0900e}
				, B1000P = #{b1000p}
				, B1000N = #{b1000n}
				, B1000C = #{b1000c}
				, B1100P = #{b1100p}
				, B1100N = #{b1100n}
				, B1100C = #{b1100c}	
			WHERE PNU = #{pnu}
		]]>				
	</update>
	
	<update id="updateLandCover" parameterType="examinationInfo">
		UPDATE DT_LANDCOVER
			SET T0100 = #{t0100}
			, T0200 = #{t0200}
			, T0300 = #{t0300}
			, T0400 = #{t0400}
			, T0500 = #{t0500}
			, T0600 = #{t0600}
			, T0700 = #{t0700}
		WHERE PNU = #{pnu}
	</update>
	
	<delete id="deleteExaminationInfo" parameterType="examinationInfoVO">
		DELETE FROM DT_COMMONINFO WHERE PNU = (SELECT PNU FROM DT_LANDCATEGORYINFO WHERE ORG_FID = ${orgFid});
		DELETE FROM DT_LANDCHARACTER WHERE PNU = (SELECT PNU FROM DT_LANDCATEGORYINFO WHERE ORG_FID = ${orgFid});
		DELETE FROM DT_HOUSECHARACTER WHERE PNU = (SELECT PNU FROM DT_LANDCATEGORYINFO WHERE ORG_FID = ${orgFid});
		DELETE FROM DT_LANDCOVER WHERE PNU = (SELECT PNU FROM DT_LANDCATEGORYINFO WHERE ORG_FID = ${orgFid});
		DELETE FROM DT_LANDCATEGORYINFO WHERE ORG_FID = ${orgFid};
    </delete>
    
    <select id="selectExaminationInfoExcelList" parameterType="examinationInfoVO" resultType="examinationInfo">
    	SELECT 
            SUBSTRING(DLCI.PNU, 1, 10) AS YPRI, SUBSTRING(DLCI.PNU, 12, 4) AS BONBUN, SUBSTRING(DLCI.PNU, 16, 4) AS BUBUN, DLCI.SHAPE, DLCI.START_DATE, END_DATE, UPDATE_DATE, DLCI.MAIN, DLCI.SUB, DLCI.ORI, DLCI.J0100, DLCI.J0200, DLCI.J0301, DLCI.J0302, DLCI.J0401, DLCI.J0401P, 
            DLCI.J0402, DLCI.J0402P, DLCI.J0403, DLCI.J0403P, DLCI.J0501, DLCI.J0501P, DLCI.J0502, DLCI.J0502P, DLCI.J0503, DLCI.J0503P, DLCI.G0100, DLCI.G0101, DLCI.SAVE_YN, DLCI.OPINION, 
            DC.C0100P, DC.C0100N, DC.C0100C, DC.C0200P, DC.C0200N, DC.C0200C, DC.C0301N, DC.C0301E, DC.C0302P, DC.C0302N, DC.C0302C, DC.C0302E, DC.C0401P, DC.C0401N, DC.C0401C,
			DC.C0402P, DC.C0402N, DC.C0402C, DC.C0403P, DC.C0403N, DC.C0403C, DC.C0500P, DC.C0500N, DC.C0500C, DC.C0601P, DC.C0601N, DC.C0601C, DC.C0602P, DC.C0602N, DC.C0602C,
			DL.L0100P, DL.L0100N, DL.L0100C, DL.L0100E, DL.L0201P, DL.L0201N, DL.L0201C, DL.L0202P, DL.L0202N, DL.L0202C, DL.L0202E, DL.L0301P, DL.L0301N, DL.L0301C, 
			DL.L0302P, DL.L0302N, DL.L0302C, DL.L0303P, DL.L0303N, DL.L0303C, DL.L0400P, DL.L0400N, DL.L0400C, DL.L0500P, DL.L0500N, DL.L0500C, DL.L0601P, DL.L0601N, DL.L0601C, 
			DL.L0602P, DL.L0602N, DL.L0602C,
			DH.B0101P, DH.B0101N, DH.B0101C, DH.B0102P, DH.B0102N, DH.B0102C, DH.B0102E, DH.B0201P, DH.B0201N, DH.B0201C, DH.B0202P, DH.B0202N, DH.B0202C, DH.B0202E, 
			DH.B0300P, DH.B0300N, DH.B0300C, DH.B0400P, DH.B0400N, DH.B0400C, DH.B0400E, DH.B0500P, DH.B0500N, DH.B0500C, DH.B0500E, DH.B0601P, DH.B0601N, DH.B0601C, 
			DH.B0602P, DH.B0602N, DH.B0602C, DH.B0602E, DH.B0700P, DH.B0700N, DH.B0700C, DH.B0800P, DH.B0800N, DH.B0800C, DH.B0900P, DH.B0900N, DH.B0900C, DH.B0900E,
			DH.B1000P, DH.B1000N, DH.B1000C, DH.B1100P, DH.B1100N, DH.B1100C, DLC.T0100, DLC.T0200, DLC.T0300, DLC.T0400, DLC.T0500, DLC.T0600, DLC.T0700
		FROM DT_LANDCATEGORYINFO DLCI
		INNER JOIN DT_COMMONINFO DC ON DLCI.PNU = DC.PNU
		INNER JOIN DT_LANDCHARACTER DL ON DLCI.PNU = DL.PNU
		INNER JOIN DT_HOUSECHARACTER DH ON DLCI.PNU = DH.PNU
		INNER JOIN DT_LANDCOVER DLC ON DLCI.PNU = DLC.PNU
		WHERE 1=1
		<choose>			
			<when test="@egovframework.com.cmm.util.EgovMybaitsUtil@isNotEmpty(pnu)">
				AND DLCI.PNU = #{pnu}
			</when>
			<when test="@egovframework.com.cmm.util.EgovMybaitsUtil@isNotEmpty(code2)">
				AND DLCI.PNU LIKE '%' || #{code2} || '%'
			</when>
		</choose>
		<choose>
			<when test="@egovframework.com.cmm.util.EgovMybaitsUtil@isEquals(searchMch,0)">
				AND J0100 = '1'
			</when>
			<when test="@egovframework.com.cmm.util.EgovMybaitsUtil@isEquals(searchMch,1)">
				AND J0100 = '2'
			</when>
		</choose>
		<choose>
			<when test="@egovframework.com.cmm.util.EgovMybaitsUtil@isEquals(searchCnd,0)">
				AND MAIN LIKE '%' || #{searchWrd} || '%'
			</when>
			<when test="@egovframework.com.cmm.util.EgovMybaitsUtil@isEquals(searchCnd,1)">
				AND SUB LIKE '%' || #{searchWrd} || '%'
			</when>
			<when test="@egovframework.com.cmm.util.EgovMybaitsUtil@isEquals(searchCnd,2)">
				AND ORI LIKE '%' || #{searchWrd} || '%'
			</when>
		</choose>
		ORDER BY DLCI.PNU
	</select>
</mapper>